Implementa un módulo SECURITY CENTER enterprise-grade con compliance y auditoría completa para millones de usuarios: 1) DOMAIN POLICIES MANAGER - CRUD completo para políticas con schema: {id: UUID, policy_name, policy_type: enum(cors/csp/rate_limit/ip_restriction/auth_requirement/data_retention), rules: JSON, priority: int, is_enabled: boolean, created_by, created_at, updated_at, applied_to: enum(global/api/dashboard/public)}; UI con tabla listando políticas activas, toggle enable/disable, modal para crear/editar con form builder dinámico según policy_type, drag-and-drop para reordenar prioridad; tipos de políticas incluyen: CORS (allowed_origins[], allowed_methods[], allowed_headers[], max_age), CSP (directives{}), Rate Limiting (requests_per_minute, burst_limit, scope: ip/user/api_key), IP Restrictions (whitelist_cidrs[], blacklist_cidrs[], geo_blocking_countries[]), Auth Requirements (require_2fa_for_roles[], session_timeout_minutes, password_policy{}), Data Retention (retention_days_by_data_type{}). 2) AUDIT LOG SYSTEM - backend endpoint GET /api/security/audit-logs con filtros (date_range, actor_id, actor_type, action_type, resource_type, resource_id, ip_address, status, severity); schema de eventos: {id: UUID, timestamp, actor_id, actor_type: enum(user/admin/system/api_key), actor_email, actor_ip, user_agent, geo_location: {country, city, lat, lng}, action: enum(login_success/login_failed/logout/password_change/password_reset_request/2fa_enabled/2fa_disabled/api_key_created/api_key_revoked/api_key_used/permission_granted/permission_revoked/role_changed/user_created/user_deleted/user_suspended/settings_changed/data_exported/data_deleted/model_update/database_query/policy_created/policy_updated/suspicious_activity), resource_type: enum(user/api_key/model/database/settings/policy/payment/invoice), resource_id, metadata: JSON, status: enum(success/failure/blocked), severity: enum(info/warning/critical), session_id, request_id}; frontend con tabla virtualizada (react-window para millones de registros), filtros avanzados en sidebar colapsable, click en row expande full details modal, export CSV/JSON con date range selector, real-time streaming de nuevos eventos via WebSocket. 3) THREAT DETECTION DASHBOARD - métricas en tiempo real: failed_logins_last_hour, blocked_requests_last_hour, suspicious_ips_detected, brute_force_attempts, anomaly_score (0-100); gráficos: login_attempts_chart (success vs failed stacked), blocked_requests_by_reason_pie, geographic_threat_map (world map con markers en suspicious locations), hourly_threat_heatmap; lista de active_threats con: threat_type, source_ip, target, first_seen, last_seen, attempts_count, status (investigating/blocked/resolved), actions (block_ip/whitelist/investigate). 4) API KEYS MANAGEMENT - tabla completa: key_id (masked: sk_...xxxx), name, created_by, created_at, last_used_at, last_used_ip, usage_count, rate_limit_tier, scopes[], status (active/revoked/expired), expires_at; acciones: create (modal con name, scopes checkboxes, expiration selector, rate_limit_tier), revoke (confirmation modal), rotate (genera nueva key, grace period para migración), view_usage (modal con usage chart y recent_requests); endpoint POST /api/security/api-keys con hashing bcrypt antes de almacenar, solo mostrar key completa una vez al crear. 5) AUTHENTICATION SETTINGS - panel de configuración: password_policy (min_length, require_uppercase, require_lowercase, require_numbers, require_special, prevent_reuse_count, max_age_days), session_settings (timeout_minutes, max_concurrent_sessions, require_reauth_for_sensitive), 2fa_settings (enabled_methods: [totp, sms, email, hardware_key], require_for_roles[], grace_period_days), oauth_providers (google, github, microsoft, saml - cada uno con client_id, enabled toggle, allowed_domains[]), login_settings (max_failed_attempts, lockout_duration_minutes, captcha_after_failures). 6) ACCESS CONTROL MATRIX - visualización de permisos: matriz rows=roles (super_admin, admin, editor, viewer, api_only, custom[]), columns=resources (users, models, payments, invoices, analytics, database, security, settings, api); cada celda muestra permissions (create/read/update/delete) con checkboxes editables para custom roles; endpoint GET /api/security/permissions/matrix, PUT /api/security/permissions/role/:roleId. 7) ACTIVE SESSIONS MONITOR - lista de sesiones activas: session_id, user_email, login_at, last_activity, ip_address, device_type (desktop/mobile/tablet), browser, os, location, status; acciones: terminate_session, terminate_all_user_sessions, terminate_all_sessions (nuclear option con confirmation); auto-refresh cada 30s, highlight sessions from new IPs in yellow, highlight concurrent sessions same user in orange. 8) IP MANAGEMENT CENTER - tabs: Whitelist (trusted IPs that bypass rate limits), Blacklist (permanently blocked), Temporary Blocks (auto-blocked with expiration), Geo Rules; cada entry: cidr_range, label, reason, created_by, created_at, expires_at, hit_count; bulk import/export de IP lists, integration con threat intelligence feeds simulado. 9) SECURITY ALERTS CONFIG - crear alertas para: failed_logins_threshold, new_country_login, multiple_ips_same_session, api_key_abuse, unusual_data_export, privilege_escalation_attempt, brute_force_detected, impossible_travel (login from distant locations in short time); cada alerta configura: condition, threshold, time_window, cooldown_period, notification_channels (email/slack/webhook/sms), severity, auto_actions (block_ip/suspend_user/revoke_session/notify_admin). 10) COMPLIANCE CENTER - checklist visual para: GDPR (data_export_capability, right_to_deletion, consent_management, breach_notification_process), SOC2 (access_controls, audit_logging, encryption_at_rest, encryption_in_transit), HIPAA si aplica, PCI-DSS para payments; cada item muestra: status (compliant/non_compliant/partial/not_applicable), last_verified, evidence_link, remediation_notes. 11) ENCRYPTION STATUS - panel mostrando: data_at_rest_encryption (algorithm, key_rotation_date, next_rotation), data_in_transit (tls_version, certificate_expiry, hsts_enabled), sensitive_fields_encryption (list of encrypted columns), backup_encryption_status, key_management_provider (aws_kms/vault/internal). 12) SECURITY REPORTS - generador de reportes: security_posture_summary (monthly), access_review_report (quarterly), incident_report_template, audit_log_export (custom range), failed_authentication_report, api_usage_by_key_report; cada reporte con: generate button, schedule option (daily/weekly/monthly), email recipients[], format (PDF/CSV/JSON). 13) REAL-TIME SECURITY METRICS WEBSOCKET - emit cada 10s: {active_users, active_sessions, requests_per_minute, blocked_requests_per_minute, failed_auths_per_minute, threat_level: enum(low/medium/high/critical), active_incidents_count}. 14) INCIDENT MANAGEMENT - cuando se detecta amenaza: crear incident con {id, type, severity, detected_at, source, target, description, status: enum(open/investigating/contained/resolved), assigned_to, timeline: [{timestamp, action, actor}], evidence: [], resolution_notes}; UI con incident list, detail view con timeline, actions (assign, escalate, resolve, add_note), post-incident review template. 15) BACKEND SECURITY - implementar: helmet.js para headers seguros, express-rate-limit con Redis store para distributed rate limiting, express-validator para input sanitization, CSRF protection, SQL injection prevention con parameterized queries, XSS prevention, secure session management con express-session + Redis store, CORS configuration estricta, request logging con sanitization de sensitive data (passwords, tokens). 16) DATABASE SCHEMA - tables: audit_logs (partitioned by month for performance), security_policies, api_keys (with hashed_key), sessions, blocked_ips, security_incidents, alert_configs, compliance_checklist; indexes optimizados para queries frecuentes (timestamp ranges, actor_id, action_type).